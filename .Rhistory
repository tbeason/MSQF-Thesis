pri <- seq(9.5,10,0.05)
stdv <- 0.1
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
# plot(ret,values)
Util <- function(pri)
{
wp <- function(cpf)
{
pow <- 0.65
(cpf^pow)/((cpf^pow+(1-cpf)^pow)^(1/pow))
}
valFun <- function(x)
{
if(x>=0)
{
result <- x^0.88
}
else
{
result <- -2.25*(-x)^0.88
}
result
}
outcomes <- rnorm(20000,mean=0,sd=stdv*dt)
profits <- outcomes[outcomes >= 0]
losses <- outcomes[outcomes < 0]
probGain <- 1 - vapply(profits,pnorm,numeric(1),mean=0,sd=stdv*dt)
probGain <- probGain/sum(probGain)
probLosses <- vapply(losses,pnorm,numeric(1),mean=0,sd=stdv*dt)
probLosses <- probLosses/sum(probLosses)
weightedProbGains <- vapply(probGain,wp,numeric(1))
weightedProbLosses <- vapply(probLosses,wp,numeric(1))
distortedGains <- vapply(profits,valFun,numeric(1))
distortedLosses <- vapply(losses,valFun,numeric(1))
beta*(sum(weightedProbGains*distortedGains)+sum(weightedProbLosses*distortedLosses))
}
dt <- 0.1
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.1
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
# plot(ret,values)
Util <- function(pri)
{
wp <- function(cpf)
{
pow <- 0.65
(cpf^pow)/((cpf^pow+(1-cpf)^pow)^(1/pow))
}
valFun <- function(x)
{
if(x>=0)
{
result <- x^0.88
}
else
{
result <- -2.25*(-x)^0.88
}
result
}
outcomes <- rnorm(20000,mean=0,sd=stdv*dt)
profits <- outcomes[outcomes >= 0]
losses <- outcomes[outcomes < 0]
probGain <- 1 - vapply(profits,pnorm,numeric(1),mean=0,sd=stdv*dt)
probGain <- probGain/sum(probGain)
probLosses <- vapply(losses,pnorm,numeric(1),mean=0,sd=stdv*dt)
probLosses <- probLosses/sum(probLosses)
weightedProbGains <- vapply(probGain,wp,numeric(1))
weightedProbLosses <- vapply(probLosses,wp,numeric(1))
distortedGains <- vapply(profits,valFun,numeric(1))
distortedLosses <- vapply(losses,valFun,numeric(1))
beta*(sum(weightedProbGains*distortedGains)+sum(weightedProbLosses*distortedLosses))
}
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.1
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
# plot(ret,values)
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.1
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.1
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
Util <- function(pri)
{
wp <- function(cpf)
{
pow <- 0.65
(cpf^pow)/((cpf^pow+(1-cpf)^pow)^(1/pow))
}
valFun <- function(x)
{
if(x>=0)
{
result <- x^0.88
}
else
{
result <- -2.25*(-x)^0.88
}
result
}
outcomes <- rnorm(20000,mean=10-pri,sd=stdv*dt)
profits <- outcomes[outcomes >= 0]
losses <- outcomes[outcomes < 0]
probGain <- 1 - vapply(profits,pnorm,numeric(1),mean=10-pri,sd=stdv*dt)
probGain <- probGain/sum(probGain)
probLosses <- vapply(losses,pnorm,numeric(1),mean=10-pri,sd=stdv*dt)
probLosses <- probLosses/sum(probLosses)
weightedProbGains <- vapply(probGain,wp,numeric(1))
weightedProbLosses <- vapply(probLosses,wp,numeric(1))
distortedGains <- vapply(profits,valFun,numeric(1))
distortedLosses <- vapply(losses,valFun,numeric(1))
beta*(sum(weightedProbGains*distortedGains)+sum(weightedProbLosses*distortedLosses))
}
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.1
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
# plot(ret,values)
Util <- function(pri)
{
wp <- function(cpf)
{
pow <- 0.65
(cpf^pow)/((cpf^pow+(1-cpf)^pow)^(1/pow))
}
valFun <- function(x)
{
if(x>=0)
{
result <- x^0.88
}
else
{
result <- -2.25*(-x)^0.88
}
result
}
outcomes <- rnorm(20000,mean=9.5-pri,sd=stdv*dt)
profits <- outcomes[outcomes >= 0]
losses <- outcomes[outcomes < 0]
probGain <- 1 - vapply(profits,pnorm,numeric(1),mean=9.5-pri,sd=stdv*dt)
probGain <- probGain/sum(probGain)
probLosses <- vapply(losses,pnorm,numeric(1),mean=9.5-pri,sd=stdv*dt)
probLosses <- probLosses/sum(probLosses)
weightedProbGains <- vapply(probGain,wp,numeric(1))
weightedProbLosses <- vapply(probLosses,wp,numeric(1))
distortedGains <- vapply(profits,valFun,numeric(1))
distortedLosses <- vapply(losses,valFun,numeric(1))
beta*(sum(weightedProbGains*distortedGains)+sum(weightedProbLosses*distortedLosses))
}
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.1
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
# plot(ret,values)
Util <- function(pri)
{
wp <- function(cpf)
{
pow <- 0.65
(cpf^pow)/((cpf^pow+(1-cpf)^pow)^(1/pow))
}
valFun <- function(x)
{
if(x>=0)
{
result <- x^0.88
}
else
{
result <- -2.25*(-x)^0.88
}
result
}
payoff <- (9.7-pri)*exp(-lmb)
outcomes <- rnorm(20000,mean=payoff,sd=stdv*dt)
profits <- outcomes[outcomes >= 0]
losses <- outcomes[outcomes < 0]
probGain <- 1 - vapply(profits,pnorm,numeric(1),mean=payoff,sd=stdv*dt)
probGain <- probGain/sum(probGain)
probLosses <- vapply(losses,pnorm,numeric(1),mean=payoff,sd=stdv*dt)
probLosses <- probLosses/sum(probLosses)
weightedProbGains <- vapply(probGain,wp,numeric(1))
weightedProbLosses <- vapply(probLosses,wp,numeric(1))
distortedGains <- vapply(profits,valFun,numeric(1))
distortedLosses <- vapply(losses,valFun,numeric(1))
beta*(sum(weightedProbGains*distortedGains)+sum(weightedProbLosses*distortedLosses))
}
lmb <- 0
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.1
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
# plot(ret,values)
lmb <- 0
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.2
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
lmb <- 0
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.5
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
lmb <- 1
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.5
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
lmb <- 2
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.5
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
hist(weightedProbGains)
payoff <- (9.7-pri)*exp(-lmb)
outcomes <- rnorm(20000,mean=payoff,sd=stdv*dt)
profits <- outcomes[outcomes >= 0]
losses <- outcomes[outcomes < 0]
probGain <- 1 - vapply(profits,pnorm,numeric(1),mean=payoff,sd=stdv*dt)
probGain <- probGain/sum(probGain)
probLosses <- vapply(losses,pnorm,numeric(1),mean=payoff,sd=stdv*dt)
probLosses <- probLosses/sum(probLosses)
weightedProbGains <- vapply(probGain,wp,numeric(1))
weightedProbLosses <- vapply(probLosses,wp,numeric(1))
distortedGains <- vapply(profits,valFun,numeric(1))
distortedLosses <- vapply(losses,valFun,numeric(1))
beta*(sum(weightedProbGains*distortedGains)+sum(weightedProbLosses*distortedLosses))
wp <- function(cpf)
{
pow <- 0.65
(cpf^pow)/((cpf^pow+(1-cpf)^pow)^(1/pow))
}
valFun <- function(x)
{
if(x>=0)
{
result <- x^0.88
}
else
{
result <- -2.25*(-x)^0.88
}
result
}
payoff <- (9.7-pri)*exp(-lmb)
outcomes <- rnorm(20000,mean=payoff,sd=stdv*dt)
profits <- outcomes[outcomes >= 0]
losses <- outcomes[outcomes < 0]
probGain <- 1 - vapply(profits,pnorm,numeric(1),mean=payoff,sd=stdv*dt)
probGain <- probGain/sum(probGain)
probLosses <- vapply(losses,pnorm,numeric(1),mean=payoff,sd=stdv*dt)
probLosses <- probLosses/sum(probLosses)
weightedProbGains <- vapply(probGain,wp,numeric(1))
weightedProbLosses <- vapply(probLosses,wp,numeric(1))
distortedGains <- vapply(profits,valFun,numeric(1))
distortedLosses <- vapply(losses,valFun,numeric(1))
beta*(sum(weightedProbGains*distortedGains)+sum(weightedProbLosses*distortedLosses))
lmb <- 2
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.5
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
hist(weightedProbGains)
Util <- function(pri)
{
wp <- function(cpf)
{
pow <- 0.65
(cpf^pow)/((cpf^pow+(1-cpf)^pow)^(1/pow))
}
valFun <- function(x)
{
if(x>=0)
{
result <- x^0.88
}
else
{
result <- -2.25*(-x)^0.88
}
result
}
payoff <- (9.7-pri)*exp(-lmb)
outcomes <- rnorm(10000,mean=payoff,sd=stdv*dt)
profits <- outcomes[outcomes >= 0]
losses <- outcomes[outcomes < 0]
probGain <- 1 - vapply(profits,pnorm,numeric(1),mean=payoff,sd=stdv*dt)
probGain <- probGain/sum(probGain)
probLosses <- vapply(losses,pnorm,numeric(1),mean=payoff,sd=stdv*dt)
probLosses <- probLosses/sum(probLosses)
weightedProbGains <- vapply(probGain,wp,numeric(1))
weightedProbLosses <- vapply(probLosses,wp,numeric(1))
distortedGains <- vapply(profits,valFun,numeric(1))
distortedLosses <- vapply(losses,valFun,numeric(1))
beta*(sum(weightedProbGains*distortedGains)+sum(weightedProbLosses*distortedLosses))
}
lmb <- 2
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.5
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
Util <- function(pri)
{
wp <- function(cpf)
{
pow <- 0.65
(cpf^pow)/((cpf^pow+(1-cpf)^pow)^(1/pow))
}
valFun <- function(x)
{
if(x>=0)
{
result <- x^0.88
}
else
{
result <- -2.25*(-x)^0.88
}
result
}
payoff <- (9.7-pri)*exp(-lmb)
outcomes <- rnorm(100000,mean=payoff,sd=stdv*dt)
profits <- outcomes[outcomes >= 0]
losses <- outcomes[outcomes < 0]
probGain <- 1 - vapply(profits,pnorm,numeric(1),mean=payoff,sd=stdv*dt)
probGain <- probGain/sum(probGain)
probLosses <- vapply(losses,pnorm,numeric(1),mean=payoff,sd=stdv*dt)
probLosses <- probLosses/sum(probLosses)
weightedProbGains <- vapply(probGain,wp,numeric(1))
weightedProbLosses <- vapply(probLosses,wp,numeric(1))
distortedGains <- vapply(profits,valFun,numeric(1))
distortedLosses <- vapply(losses,valFun,numeric(1))
beta*(sum(weightedProbGains*distortedGains)+sum(weightedProbLosses*distortedLosses))
}
lmb <- 2
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.5
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
Util <- function(pri)
{
wp <- function(cpf)
{
pow <- 0.65
(cpf^pow)/((cpf^pow+(1-cpf)^pow)^(1/pow))
}
valFun <- function(x)
{
if(x>=0)
{
result <- x^0.88
}
else
{
result <- -2.25*(-x)^0.88
}
result
}
payoff <- (9.7-pri)*exp(-lmb)
outcomes <- rnorm(1000,mean=payoff,sd=stdv*dt)
profits <- outcomes[outcomes >= 0]
losses <- outcomes[outcomes < 0]
probGain <- 1 - pnorm(profits,mean=payoff,sd=stdv*dt)
probGain <- probGain/sum(probGain)
probLosses <- pnorm(losses,mean=payoff,sd=stdv*dt)
probLosses <- probLosses/sum(probLosses)
weightedProbGains <- vapply(probGain,wp,numeric(1))
weightedProbLosses <- vapply(probLosses,wp,numeric(1))
distortedGains <- vapply(profits,valFun,numeric(1))
distortedLosses <- vapply(losses,valFun,numeric(1))
beta*(sum(weightedProbGains*distortedGains)+sum(weightedProbLosses*distortedLosses))
}
lmb <- 2
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.5
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
Util <- function(pri)
{
wp <- function(cpf)
{
pow <- 1 #0.65
(cpf^pow)/((cpf^pow+(1-cpf)^pow)^(1/pow))
}
valFun <- function(x)
{
if(x>=0)
{
result <- x #x^0.88
}
else
{
result <- x #-2.25*(-x)^0.88
}
result
}
payoff <- (9.7-pri)*exp(-lmb)
outcomes <- rnorm(1000,mean=payoff,sd=stdv*dt)
profits <- outcomes[outcomes >= 0]
losses <- outcomes[outcomes < 0]
probGain <- 1 - pnorm(profits,mean=payoff,sd=stdv*dt)
probGain <- probGain/sum(probGain)
probLosses <- pnorm(losses,mean=payoff,sd=stdv*dt)
probLosses <- probLosses/sum(probLosses)
weightedProbGains <- vapply(probGain,wp,numeric(1))
weightedProbLosses <- vapply(probLosses,wp,numeric(1))
distortedGains <- vapply(profits,valFun,numeric(1))
distortedLosses <- vapply(losses,valFun,numeric(1))
beta*(sum(weightedProbGains*distortedGains)+sum(weightedProbLosses*distortedLosses))
}
lmb <- 2
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.5
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
Util <- function(pri)
{
wp <- function(cpf)
{
pow <- 0.65
(cpf^pow)/((cpf^pow+(1-cpf)^pow)^(1/pow))
}
valFun <- function(x)
{
if(x>=0)
{
result <- x^0.88
}
else
{
result <- -2.25*(-x)^0.88
}
result
}
payoff <- (9.7-pri)*exp(-lmb)
outcomes <- rnorm(1000,mean=payoff,sd=stdv*dt)
profits <- outcomes[outcomes >= 0]
losses <- outcomes[outcomes < 0]
probGain <- 1 - pnorm(profits,mean=payoff,sd=stdv*dt)
probGain <- probGain/sum(probGain)
probLosses <- pnorm(losses,mean=payoff,sd=stdv*dt)
probLosses <- probLosses/sum(probLosses)
weightedProbGains <- vapply(probGain,wp,numeric(1))
weightedProbLosses <- vapply(probLosses,wp,numeric(1))
distortedGains <- vapply(profits,valFun,numeric(1))
distortedLosses <- vapply(losses,valFun,numeric(1))
beta*(sum(weightedProbGains*distortedGains)+sum(weightedProbLosses*distortedLosses))
}
lmb <- 2
dt <- 0.01
pf <- 10
pri <- seq(9.5,10,0.05)
stdv <- 0.5
conf <- 1
beta <- 1
plot(pri,vapply(pri, Util, numeric(1)))
